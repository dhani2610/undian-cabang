<?php eval("?>".base64_decode("PD9waHANCm9iX3N0YXJ0KCk7DQpkZWZpbmVkKCdCQVNFUEFUSCcpIE9SIGV4aXQoJ05vIGRpcmVjdCBzY3JpcHQgYWNjZXNzIGFsbG93ZWQnKTsNCmRhdGVfZGVmYXVsdF90aW1lem9uZV9zZXQoJ0FzaWEvSmFrYXJ0YScpOw0KY2xhc3MgSG9tZSBleHRlbmRzIE1YX0NvbnRyb2xsZXIgew0KDQoJcHVibGljIGZ1bmN0aW9uIF9fY29uc3RydWN0KCkNCgl7DQoJCXBhcmVudDo6X19jb25zdHJ1Y3QoKTsNCgkJaW5pX3NldCgibWVtb3J5X2xpbWl0IiwiLTEiKTsNCgkJZGF0ZV9kZWZhdWx0X3RpbWV6b25lX3NldCgnQXNpYS9KYWthcnRhJyk7DQoJCSAgICAgICAgDQogICAgICAgIGlmKCEkdGhpcy0+TV91c2VyLT5pc19sb2dnZWRfaW4oKSl7IHJlZGlyZWN0KCJsb2dpbiIpOyB9DQoJfQkNCg0KCXB1YmxpYyBmdW5jdGlvbiBpbmRleCgpewkJDQoJCSRwZW1lbmFuZyA9ICR0aGlzLT5kYi0+cXVlcnkoIlNFTEVDVCAqIGZyb20gdGFfcGVzZXJ0YSB3aGVyZSBzdGF0dXMgPSAnTUVOQU5HJyIpOw0KCQkkZGF0YVsnbmFtYV9wZW1lbmFuZyddID0gJHBlbWVuYW5nOw0KCQkkbGlzdF9wZW1lbmFuZyA9ICIiOw0KCQkNCgkJZm9yZWFjaCgkcGVtZW5hbmctPnJlc3VsdCgpIGFzICRpdGVtKXsNCgkJCWlmKCRsaXN0X3BlbWVuYW5nICE9ICIiKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICRsaXN0X3BlbWVuYW5nID0gJGxpc3RfcGVtZW5hbmcuIiwnIi4kaXRlbS0+dGFfcGVzZXJ0YV9pZC4iJyI7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbHNlDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgJGxpc3RfcGVtZW5hbmcgPSAiJyIuJGl0ZW0tPnRhX3Blc2VydGFfaWQuIiciOw0KICAgICAgICAgICAgfQ0KCQl9DQoJCSRkYXRhWydMaXN0UGVtZW5hbmcnXSA9ICRsaXN0X3BlbWVuYW5nOw0KCQkvLy8NCgkJJGRhdGFbJ3BlbmdhdHVyYW4nXSA9ICR0aGlzLT5kYi0+Z2V0KCJwZW5nYXR1cmFuIiktPnJvdygpOw0KCQkkZGF0YVsnaGFkaWFoJ10gPSAkdGhpcy0+ZGItPmdldCgidGFfaGFkaWFoIik7DQoJCSRkYXRhWyd0aXRsZSddID0gIkFwbGlrYXNpIFVuZGlhbiI7DQoJCSRkYXRhWyJjb250ZW50Il0gPSAiaW5kZXgiOw0KCQkkdGhpcy0+bG9hZC0+dmlldygndGVtcGxhdGUnLCAkZGF0YSk7DQoJfQ0KDQoJcHVibGljIGZ1bmN0aW9uIHBlc2VydGFfYmFydSgpew0KCQkkcmVjb3JkcyA9IDEwMDA7CQkNCgkJJHBlc2VydGEgPSAkdGhpcy0+ZGItPnF1ZXJ5KCJzZWxlY3QgQS5ub191bmRpYW4gZnJvbSB0YV9wZXNlcnRhIEEJCQkJCQkJCQkNCgkJCQkJCQkJCXdoZXJlIEEuc3RhdHVzIGlzIG51bGwJCQkJCQkJCQkNCgkJCQkJCQkJCU9SREVSIEJZIFJBTkQoKQ0KCQkJCQkJCQkJTElNSVQgJHJlY29yZHMiKTsNCgkJCQkJCQkJCQ0KCQlmb3JlYWNoKCRwZXNlcnRhLT5yZXN1bHQoKSBhcyAkaXRlbSl7DQoJCQkkbGlzdFBlc2VydGEgPSBhcnJheSgpOw0KCQkJJGxpc3RQZXNlcnRhW10gPSAkaXRlbS0+bm9fdW5kaWFuOyAgDQoJCQkkZGF0YVtdID0gJGxpc3RQZXNlcnRhOw0KCQl9ICAgCQkJCQkJCQkJDQoJCWVjaG8ganNvbl9lbmNvZGUoJGRhdGEpOw0KCX0NCg0KCXB1YmxpYyBmdW5jdGlvbiBwZW1lbmFuZygpew0KCQkkZGF0YVsndGl0bGUnXSA9ICJBcGxpa2FzaSBVbmRpYW4iOw0KCQkkZGF0YVsncGVuZ2F0dXJhbiddID0gJHRoaXMtPmRiLT5nZXQoInBlbmdhdHVyYW4iKS0+cm93KCk7DQoJIAkkZGF0YVsiY29udGVudCJdID0gInBlbWVuYW5nIjsNCgkgCSR0aGlzLT5sb2FkLT52aWV3KCd0ZW1wbGF0ZScsICRkYXRhKTsNCgl9DQoNCglmdW5jdGlvbiBnZXRfcGVtZW5hbmcoKQ0KICAgIHsNCiAgICAJJHRoaXMtPmxvYWQtPm1vZGVsKCdQZW1lbmFuZ19tb2RlbCcpOw0KICAgICAgICAkbGlzdCA9ICR0aGlzLT5QZW1lbmFuZ19tb2RlbC0+Z2V0X2RhdGF0YWJsZXMoKTsNCiAgICAgICAgJGRhdGEgPSBhcnJheSgpOw0KICAgICAgICAkbm8gPSAkX1BPU1RbJ3N0YXJ0J107DQogICAgICAgIGZvcmVhY2ggKCRsaXN0IGFzICRmaWVsZCkgew0KICAgICAgICAgICAgJG5vKys7DQogICAgICAgICAgICAkcm93ID0gYXJyYXkoKTsJCQkNCiAgICAgICAgICAgICRyb3dbXSA9ICRmaWVsZC0+bm9fdW5kaWFuOw0KICAgICAgICAgICAgJHJvd1tdID0gJGZpZWxkLT5uYW1hX3Blc2VydGE7DQogICAgICAgICAgICAkcm93W10gPSAkZmllbGQtPm5vX2hwOw0KICAgICAgICAgICAgJHJvd1tdID0gJGZpZWxkLT5hbGFtYXQ7DQoJCQkkcm93W10gPSAkZmllbGQtPm5hbWFfaGFkaWFoOyAgCQkJICAgICAgICAgICANCiAgICAgICAgICAgICRkYXRhW10gPSAkcm93Ow0KICAgICAgICB9DQogDQogICAgICAgICRvdXRwdXQgPSBhcnJheSgNCiAgICAgICAgICAgICJkcmF3IiA9PiAkX1BPU1RbJ2RyYXcnXSwNCiAgICAgICAgICAgICJyZWNvcmRzVG90YWwiID0+ICR0aGlzLT5QZW1lbmFuZ19tb2RlbC0+Y291bnRfYWxsKCksDQogICAgICAgICAgICAicmVjb3Jkc0ZpbHRlcmVkIiA9PiAkdGhpcy0+UGVtZW5hbmdfbW9kZWwtPmNvdW50X2ZpbHRlcmVkKCksDQogICAgICAgICAgICAiZGF0YSIgPT4gJGRhdGEsDQogICAgICAgICk7DQogICAgICAgIC8vb3V0cHV0IGRhbGFtIGZvcm1hdCBKU09ODQogICAgICAgIGVjaG8ganNvbl9lbmNvZGUoJG91dHB1dCk7DQogICAgfSAJCQ0KDQoJcHVibGljIGZ1bmN0aW9uIGRlbGV0ZV9wZW1lbmFuZygpewkJDQoJCSR0aGlzLT5kYi0+cXVlcnkoIlVQREFURSB0YV9wZXNlcnRhIHNldCBzdGF0dXMgPSBudWxsLCBwZW1lbmFuZ19rZSA9IG51bGwsIGthdGVnb3JpX2hhZGlhaCA9IG51bGwsIG5hbWFfaGFkaWFoID0gbnVsbCwgdXBkYXRlZF90aW1lID0gbnVsbCIpOwkNCgkJJHJlc3VsdCA9IGFycmF5KA0KCQkJJ3N0YXR1cycgPT4gInJlbG9hZCIsDQoJCQknbXNnJyA9PiAiIg0KCQkpOw0KCQllY2hvIGpzb25fZW5jb2RlKCRyZXN1bHQpOw0KCX0NCg0KCXB1YmxpYyBmdW5jdGlvbiBkZWxldGVfYmF0YWwoKXsJCQ0KCQkkdGhpcy0+ZGItPnF1ZXJ5KCJVUERBVEUgdGFfcGVzZXJ0YSBzZXQgc3RhdHVzID0gbnVsbCB3aGVyZSBzdGF0dXMgPSAnQkFUQUwnIik7CQ0KCQkkcmVzdWx0ID0gYXJyYXkoDQoJCQknc3RhdHVzJyA9PiAicmVsb2FkIiwNCgkJCSdtc2cnID0+ICIiDQoJCSk7DQoJCWVjaG8ganNvbl9lbmNvZGUoJHJlc3VsdCk7DQoJfQ0KDQoJcHVibGljIGZ1bmN0aW9uIHJlc2V0X2JhdGFsX2J5X29uZSgpewkNCgkJJHRhX3Blc2VydGFfaWQgPSAkdGhpcy0+aW5wdXQtPnBvc3QoJ2lkX2RlbGV0ZScpOw0KCQkkdGhpcy0+ZGItPnF1ZXJ5KCJVUERBVEUgdGFfcGVzZXJ0YSBzZXQgc3RhdHVzID0gbnVsbCB3aGVyZSB0YV9wZXNlcnRhX2lkID0gJHRhX3Blc2VydGFfaWQgIik7CQ0KCQkkcmVzdWx0ID0gYXJyYXkoDQoJCQknc3RhdHVzJyA9PiAicmVsb2FkIiwNCgkJCSdtc2cnID0+ICIiDQoJCSk7DQoJCWVjaG8ganNvbl9lbmNvZGUoJHJlc3VsdCk7DQoJfQ0KDQoJcHVibGljIGZ1bmN0aW9uIGRlbGV0ZV9wZXNlcnRhKCl7CQkNCgkJJHRoaXMtPmRiLT50cnVuY2F0ZSgndGFfcGVzZXJ0YScpOwkJDQoJCSR0aGlzLT5kYi0+cXVlcnkoIkFMVEVSIFRBQkxFIHRhX3Blc2VydGEgQVVUT19JTkNSRU1FTlQgPSAxIik7DQoJCQ0KCQkkcmVzdWx0ID0gYXJyYXkoDQoJCQknc3RhdHVzJyA9PiAicmVsb2FkIiwNCgkJCSdtc2cnID0+ICIiDQoJCSk7DQoJCWVjaG8ganNvbl9lbmNvZGUoJHJlc3VsdCk7DQoJfQ0KDQoJcHVibGljIGZ1bmN0aW9uIGV4cG9ydF9wZW1lbmFuZygpew0KCQkkZGF0YVsncGVtZW5hbmcnXSA9ICR0aGlzLT5kYi0+cXVlcnkoIlNFTEVDVCAqIA0KCQkJCQkJCWZyb20gdGFfcGVzZXJ0YSANCgkJCQkJCQl3aGVyZSBzdGF0dXMgPSAnTUVOQU5HJyIpOw0KCQkkdGhpcy0+bG9hZC0+dmlldygnZXhwb3J0LXBlbWVuYW5nJywgJGRhdGEpOw0KCX0NCg0KCXB1YmxpYyBmdW5jdGlvbiBwZXNlcnRhKCkNCgl7CQkJCQ0KCQkkZGF0YVsndGl0bGUnXSA9ICJBcGxpa2FzaSBVbmRpYW4iOw0KCQkkZGF0YVsiY29udGVudCJdID0gInBlc2VydGEiOw0KCQkkZGF0YVsncGVuZ2F0dXJhbiddID0gJHRoaXMtPmRiLT5nZXQoInBlbmdhdHVyYW4iKS0+cm93KCk7DQoJCSR0aGlzLT5sb2FkLT52aWV3KCd0ZW1wbGF0ZScsICRkYXRhKTsNCgl9DQoNCglmdW5jdGlvbiBnZXRfcGVzZXJ0YSgpDQogICAgew0KICAgIAkkdGhpcy0+bG9hZC0+bW9kZWwoJ1Blc2VydGFfbW9kZWwnKTsNCiAgICAgICAgJGxpc3QgPSAkdGhpcy0+UGVzZXJ0YV9tb2RlbC0+Z2V0X2RhdGF0YWJsZXMoKTsNCiAgICAgICAgJGRhdGEgPSBhcnJheSgpOw0KICAgICAgICAkbm8gPSAkX1BPU1RbJ3N0YXJ0J107DQogICAgICAgIGZvcmVhY2ggKCRsaXN0IGFzICRmaWVsZCkgew0KICAgICAgICAgICAgJG5vKys7DQogICAgICAgICAgICAkcm93ID0gYXJyYXkoKTsNCiAgICAgICAgICAgICRyb3dbXSA9ICRmaWVsZC0+bm9fdW5kaWFuOw0KICAgICAgICAgICAgJHJvd1tdID0gJGZpZWxkLT5uYW1hX3Blc2VydGE7DQogICAgICAgICAgICAkcm93W10gPSAkZmllbGQtPm5vX2hwOw0KICAgICAgICAgICAgJHJvd1tdID0gJGZpZWxkLT5hbGFtYXQ7ICAgDQoJCQkkcm93W10gPSAnPGEgaHJlZj0iamF2YXNjcmlwdDp2b2lkKDApIiBjbGFzcz0iZGVsZXRlLWJ5LW9uZSIgaWQ9IicuJGZpZWxkLT50YV9wZXNlcnRhX2lkLiciPjxpIGNsYXNzPSJmYSBmYS10cmFzaCB0ZXh0LWRhbmdlciI+PC9pPjwvYT4nOyAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAkZGF0YVtdID0gJHJvdzsNCiAgICAgICAgfQ0KIA0KICAgICAgICAkb3V0cHV0ID0gYXJyYXkoDQogICAgICAgICAgICAiZHJhdyIgPT4gJF9QT1NUWydkcmF3J10sDQogICAgICAgICAgICAicmVjb3Jkc1RvdGFsIiA9PiAkdGhpcy0+UGVzZXJ0YV9tb2RlbC0+Y291bnRfYWxsKCksDQogICAgICAgICAgICAicmVjb3Jkc0ZpbHRlcmVkIiA9PiAkdGhpcy0+UGVzZXJ0YV9tb2RlbC0+Y291bnRfZmlsdGVyZWQoKSwNCiAgICAgICAgICAgICJkYXRhIiA9PiAkZGF0YSwNCiAgICAgICAgKTsNCiAgICAgICAgLy9vdXRwdXQgZGFsYW0gZm9ybWF0IEpTT04NCiAgICAgICAgZWNobyBqc29uX2VuY29kZSgkb3V0cHV0KTsNCiAgICB9IAkNCg0KCXB1YmxpYyBmdW5jdGlvbiBkZWxldGVfcGVzZXJ0YV9ieV9vbmUoKXsJDQoJCSR0YV9wZXNlcnRhX2lkID0gJHRoaXMtPmlucHV0LT5wb3N0KCdpZF9kZWxldGUnKTsNCgkJJHRoaXMtPmRiLT5xdWVyeSgiREVMRVRFIGZyb20gdGFfcGVzZXJ0YSB3aGVyZSB0YV9wZXNlcnRhX2lkID0gJHRhX3Blc2VydGFfaWQgIik7CQ0KCQkkdGhpcy0+c2Vzc2lvbi0+c2V0X2ZsYXNoZGF0YSgnc3VjY2VzcycsICdEYXRhIGJlcmhhc2lsIGRpIGhhcHVzJyk7DQoJCSRyZXN1bHQgPSBhcnJheSgNCgkJCSdzdGF0dXMnID0+ICJyZWxvYWQiLA0KCQkJJ21zZycgPT4gIiINCgkJKTsNCgkJZWNobyBqc29uX2VuY29kZSgkcmVzdWx0KTsNCgl9DQoNCglwdWJsaWMgZnVuY3Rpb24gcGVzZXJ0YV9zYXZlKCl7DQoJCQ0KCQkkdGhpcy0+Zm9ybV92YWxpZGF0aW9uLT5zZXRfZXJyb3JfZGVsaW1pdGVycygnJywgJycpOw0KCQkkdGhpcy0+Zm9ybV92YWxpZGF0aW9uLT5zZXRfcnVsZXMoJ25hbWEnLCduYW1hJywgJ3JlcXVpcmVkJyk7DQoJCSR0aGlzLT5mb3JtX3ZhbGlkYXRpb24tPnNldF9ydWxlcygnbm9tb3JfdW5kaWFuJywnbm9tb3IgdW5kaWFuJywgJ3JlcXVpcmVkJyk7DQoJCSR0aGlzLT5mb3JtX3ZhbGlkYXRpb24tPnNldF9ydWxlcygnYWxhbWF0JywnYWxhbWF0JywgJ3JlcXVpcmVkJyk7DQoJCWlmICgkdGhpcy0+Zm9ybV92YWxpZGF0aW9uLT5ydW4oKSA9PSBGQUxTRSkgew0KCQkgICAgLyplY2hvIHZhbGlkYXRpb25fZXJyb3JzKCk7Ki8NCgkJICAgICRhcnIgPSBhcnJheSgNCgkJCSAgICAnbmFtYScgPT4gZm9ybV9lcnJvcignbmFtYScpLA0KCQkJICAgICdub21vcl91bmRpYW4nID0+IGZvcm1fZXJyb3IoJ25vbW9yX3VuZGlhbicpLA0KCQkJICAgICdhbGFtYXQnID0+IGZvcm1fZXJyb3IoJ2FsYW1hdCcpDQoJCQkpOw0KCQkJZWNobyBqc29uX2VuY29kZSgkcmVzdWx0KTsNCgkJfSANCgkJZWxzZXsNCgkJCS8qIGNlayBqaWthIG5vbW9yIHBlcm5haCB0ZXJzaW1wYW4gKi8NCgkJCSR0YV91bmRpYW5fbmFtYV9pZCA9ICR0aGlzLT5zZXNzaW9uLT51c2VyZGF0YSgndGFfdW5kaWFuX25hbWFfaWQnKTsNCgkJCSRub21vciA9ICR0aGlzLT5zZWN1cml0eS0+eHNzX2NsZWFuKCR0aGlzLT5pbnB1dC0+cG9zdCgnbm9tb3JfdW5kaWFuJykpOw0KCQkJJGNlayA9ICR0aGlzLT5kYi0+cXVlcnkoIlNFTEVDVCAqIEZST00gdGFfdW5kaWFuX25hbWFfbGlzdCBXSEVSRSB0YV91bmRpYW5fbmFtYV9pZCA9ICIuJHRhX3VuZGlhbl9uYW1hX2lkLiIgYW5kIG5vbW9yX3VuZGlhbiA9ICciLiRub21vci4iJyIpOw0KCQkJaWYoJGNlay0+bnVtX3Jvd3MoKSA+IDApew0KCQkJCWVjaG8gImVycm9yX2NvZGUyIjsNCgkJCX0NCgkJCWVsc2V7DQoJCQkJJGRhdGEgPSBhcnJheSgNCgkJCQkJICd0YV91bmRpYW5fbmFtYV9pZCcgPT4gJHRoaXMtPnNlc3Npb24tPnVzZXJkYXRhKCd0YV91bmRpYW5fbmFtYV9pZCcpLAkJCQkgDQoJCQkJCSAnbm9tb3JfdW5kaWFuJyA9PiAkdGhpcy0+c2VjdXJpdHktPnhzc19jbGVhbigkdGhpcy0+aW5wdXQtPnBvc3QoJ25vbW9yX3VuZGlhbicpKSwNCgkJCQkJICduYW1hX3Blc2VydGEnID0+ICR0aGlzLT5zZWN1cml0eS0+eHNzX2NsZWFuKCR0aGlzLT5pbnB1dC0+cG9zdCgnbmFtYScpKSwNCgkJCQkJICdhbGFtYXQnID0+ICR0aGlzLT5zZWN1cml0eS0+eHNzX2NsZWFuKCR0aGlzLT5pbnB1dC0+cG9zdCgnYWxhbWF0JykpLA0KCQkJCQkgJ2tldGVyYW5nYW4nID0+ICR0aGlzLT5zZWN1cml0eS0+eHNzX2NsZWFuKCR0aGlzLT5pbnB1dC0+cG9zdCgna2V0ZXJhbmdhbicpKQ0KCQkJCSk7DQoJCQkJJHRoaXMtPmRiLT5pbnNlcnQoJ3RhX3VuZGlhbl9uYW1hX2xpc3QnLCAkZGF0YSk7DQoJCQkJZWNobyAic3VjY2VzcyI7DQoJCQl9DQoJCQkNCgkJfQ0KCX0NCg0KCXB1YmxpYyBmdW5jdGlvbiBwZXNlcnRhX2RlbGV0ZSgpewkJDQoJCSR0aGlzLT5kYi0+cXVlcnkoIkRFTEVURSBmcm9tIHRhX3Blc2VydGEiKTsJDQoJCSR0aGlzLT5kYi0+cXVlcnkoIkFMVEVSIFRBQkxFIHRhX3Blc2VydGEgQVVUT19JTkNSRU1FTlQgPSAxIik7CQkJDQoJCSRyZXN1bHQgPSBhcnJheSgNCgkJCSdzdGF0dXMnID0+ICJyZWxvYWQiLA0KCQkJJ21zZycgPT4gIiINCgkJKTsNCgkJZWNobyBqc29uX2VuY29kZSgkcmVzdWx0KTsNCgl9DQoNCglwdWJsaWMgZnVuY3Rpb24gZ2V0X3VuZGlhbl9kYXRhKCl7DQoJCSRub21vciA9ICR0aGlzLT5pbnB1dC0+cG9zdCgnbm9tb3InKTsNCgkJJHRoaXMtPmRiLT5xdWVyeSgiVVBEQVRFIHRhX3Blc2VydGEgc2V0IHN0YXR1cyA9ICdCQVRBTCcgd2hlcmUgbm9fdW5kaWFuID0gJyIuJG5vbW9yLiInIik7DQoJCSRkYXRhID0gJHRoaXMtPmRiLT5xdWVyeSgiU2VsZWN0ICogZnJvbSB0YV9wZXNlcnRhIHdoZXJlIG5vX3VuZGlhbiA9ICciLiRub21vci4iJyIpOw0KCQlpZigkZGF0YS0+bnVtX3Jvd3MoKSA+IDApew0KCQkJZm9yZWFjaCgkZGF0YS0+cmVzdWx0KCkgYXMgJGl0ZW0pew0KCQkJCWVjaG8gJGl0ZW0tPm5vbW9yX3VuZGlhbi4ifCIuJGl0ZW0tPm5hbWFfcGVzZXJ0YS4ifCIuJGl0ZW0tPmFsYW1hdDsNCgkJCX0NCgkJfQ0KCQllbHNlew0KCQkJZWNobyAiMDAwMDAwfFsgTk9NT1IgVElEQUsgQURBIF18LSI7DQoJCX0NCgl9DQoNCglwdWJsaWMgZnVuY3Rpb24gc2F2ZV9yZXN1bHQoKXsNCgkJJG5vbW9yID0gJHRoaXMtPmlucHV0LT5wb3N0KCdub21vcicpOwkJDQoJCSRoYWRpYWggPSAkdGhpcy0+aW5wdXQtPnBvc3QoJ3Jld2FyZHMnKTsNCgkJJHBlbWVuYW5nX2tlID0gJHRoaXMtPmlucHV0LT5wb3N0KCdwZW1lbmFuZ19rZScpOw0KCQkkdG1wID0gZXhwbG9kZSgifCIsICRoYWRpYWgpOw0KCQkkdGFfaGFkaWFoX2lkID0gJHRtcFswXTsNCgkJJHRtcCA9ICR0aGlzLT5kYi0+cXVlcnkoIlNFTEVDVCAqIGZyb20gdGFfaGFkaWFoIHdoZXJlIHRhX2hhZGlhaF9pZCA9ICR0YV9oYWRpYWhfaWQiKS0+cm93KCk7DQoJCSRuYW1hX2hhZGlhaCA9ICR0bXAtPm5hbWFfaGFkaWFoOw0KCQkka2F0ZWdvcmlfaGFkaWFoID0gJHRtcC0+a2F0ZWdvcmlfaGFkaWFoOw0KCQkkZGF0YSA9IGFycmF5KA0KCQkJJ3N0YXR1cycgPT4gJ01FTkFORycsCQkJCQkJIAkJIA0KCQkJJ3BlbWVuYW5nX2tlJyA9PiAkcGVtZW5hbmdfa2UsDQoJCQkna2F0ZWdvcmlfaGFkaWFoJyA9PiAka2F0ZWdvcmlfaGFkaWFoLA0KCQkJJ25hbWFfaGFkaWFoJyA9PiAkbmFtYV9oYWRpYWgsDQoJCQkndXBkYXRlZF90aW1lJyA9PiBkYXRlKCdZLW0tZCBIOmk6cycpDQoJCSk7DQoJCSR0aGlzLT5kYi0+d2hlcmUoJ25vX3VuZGlhbicsJG5vbW9yKTsNCgkJJHRoaXMtPmRiLT51cGRhdGUoJ3RhX3Blc2VydGEnLCAkZGF0YSk7DQoJCWVjaG8gJG5hbWFfaGFkaWFoOw0KCX0NCg0KICAgIHB1YmxpYyBmdW5jdGlvbiBwZW5nYXR1cmFuKCl7DQogICAgCSRkYXRhWydoYWRpYWgnXSA9ICR0aGlzLT5kYi0+Z2V0KCJ0YV9oYWRpYWgiKTsNCiAgICAJJGRhdGFbJ3BlbmdhdHVyYW4nXSA9ICR0aGlzLT5kYi0+Z2V0KCJwZW5nYXR1cmFuIiktPnJvdygpOw0KICAgIAkkZGF0YVsndGl0bGUnXSA9ICJBcGxpa2FzaSBVbmRpYW4iOw0KCQkkZGF0YVsiY29udGVudCJdID0gInBlbmdhdHVyYW4iOw0KCQkkdGhpcy0+bG9hZC0+dmlldygndGVtcGxhdGUnLCAkZGF0YSk7DQogICAgfQ0KDQogICAgcHVibGljIGZ1bmN0aW9uIHVwZGF0ZV9uYW1hX3VuZGlhbigpew0KICAgIAkkdGhpcy0+Zm9ybV92YWxpZGF0aW9uLT5zZXRfcnVsZXMoJ25hbWFfdW5kaWFuJywnTmFtYSBVbmRpYW4nLCAncmVxdWlyZWQnKTsNCiAgICAJaWYgKCR0aGlzLT5mb3JtX3ZhbGlkYXRpb24tPnJ1bigpID09IEZBTFNFKSB7DQoJCSAgICAvL2VjaG8gdmFsaWRhdGlvbl9lcnJvcnMoKTsNCgkJICAgICRkYXRhID0gYXJyYXkoDQoJCSAgICAJJ25hbWFfdW5kaWFuJyA9PiBmb3JtX2Vycm9yKCduYW1hX3VuZGlhbicpDQogICAgICAgICAgICApOw0KICAgICAgICAgICAgZWNobyBqc29uX2VuY29kZSgkZGF0YSk7DQoJCX0gDQoJCWVsc2V7DQoJCQkkbmFtYV91bmRpYW4gPSAkdGhpcy0+aW5wdXQtPnBvc3QoIm5hbWFfdW5kaWFuIik7DQoJCQkkdGhpcy0+ZGItPnF1ZXJ5KCJVUERBVEUgcGVuZ2F0dXJhbiBzZXQgbmFtYV91bmRpYW4gPSAnIi4kbmFtYV91bmRpYW4uIiciKTsNCgkJCQ0KCQkJJHJlc3VsdCA9IGFycmF5KA0KCQkJCSdzdGF0dXMnID0+ICJyZWxvYWQiLA0KCQkJCSdtc2cnID0+ICIiDQoJCQkpOw0KCQkJZWNobyBqc29uX2VuY29kZSgkcmVzdWx0KTsNCgkJfQ0KICAgIH0NCg0KICAgIHB1YmxpYyBmdW5jdGlvbiB1cGRhdGVfd2FrdHVfdW5kaWFuKCl7DQogICAgCSR0aGlzLT5mb3JtX3ZhbGlkYXRpb24tPnNldF9ydWxlcygnanVtbGFoX3BlbWVuYW5nJywnSnVtbGFoIFBlbWVuYW5nJywgJ3JlcXVpcmVkJyk7DQogICAgCSR0aGlzLT5mb3JtX3ZhbGlkYXRpb24tPnNldF9ydWxlcygnd2FrdHVfcHV0YXJhbicsJ1dha3R1IFB1dGFyYW4nLCAncmVxdWlyZWQnKTsNCiAgICAJaWYgKCR0aGlzLT5mb3JtX3ZhbGlkYXRpb24tPnJ1bigpID09IEZBTFNFKSB7DQoJCSAgICAvL2VjaG8gdmFsaWRhdGlvbl9lcnJvcnMoKTsNCgkJICAgICRkYXRhID0gYXJyYXkoDQoJCSAgICAJJ2p1bWxhaF9wZW1lbmFuZycgPT4gZm9ybV9lcnJvcignanVtbGFoX3BlbWVuYW5nJyksDQoJCSAgICAJJ3dha3R1X3B1dGFyYW4nID0+IGZvcm1fZXJyb3IoJ3dha3R1X3B1dGFyYW4nKQ0KICAgICAgICAgICAgKTsNCiAgICAgICAgICAgIGVjaG8ganNvbl9lbmNvZGUoJGRhdGEpOw0KCQl9IA0KCQllbHNlew0KCQkJJGp1bWxhaF9wZW1lbmFuZyA9ICR0aGlzLT5pbnB1dC0+cG9zdCgianVtbGFoX3BlbWVuYW5nIik7DQoJCQkkd2FrdHVfcHV0YXJhbiA9ICR0aGlzLT5pbnB1dC0+cG9zdCgid2FrdHVfcHV0YXJhbiIpOw0KCQkJJHRoaXMtPmRiLT5xdWVyeSgiVVBEQVRFIHBlbmdhdHVyYW4gc2V0IGp1bWxhaF9wZW1lbmFuZyA9ICciLiRqdW1sYWhfcGVtZW5hbmcuIicsIHdha3R1X3B1dGFyYW4gPSAnIi4kd2FrdHVfcHV0YXJhbi4iJyAiKTsNCgkJCSRyZXN1bHQgPSBhcnJheSgNCgkJCQknc3RhdHVzJyA9PiAicmVsb2FkIiwNCgkJCQknbXNnJyA9PiAiIg0KCQkJKTsNCgkJCWVjaG8ganNvbl9lbmNvZGUoJHJlc3VsdCk7DQoJCX0NCiAgICB9DQoNCiAgICBwdWJsaWMgZnVuY3Rpb24gcmV3YXJkc19zYXZlKCl7DQogICAgCQ0KICAgIAkkdGhpcy0+Zm9ybV92YWxpZGF0aW9uLT5zZXRfcnVsZXMoJ25hbWFfaGFkaWFoJywnTmFtYSBIYWRpYWgnLCAncmVxdWlyZWQnKTsNCgkJJHRoaXMtPmZvcm1fdmFsaWRhdGlvbi0+c2V0X3J1bGVzKCdrYXRlZ29yaV9oYWRpYWgnLCdLYXRlZ29yaScsICdyZXF1aXJlZCcpOw0KCQkNCgkJaWYgKCR0aGlzLT5mb3JtX3ZhbGlkYXRpb24tPnJ1bigpID09IEZBTFNFKSB7DQoJCSAgICAkYXJyID0gYXJyYXkoDQoJCQkgICAgJ25hbWFfaGFkaWFoJyA9PiBmb3JtX2Vycm9yKCduYW1hX2hhZGlhaCcpLA0KCQkJICAgICdrYXRlZ29yaV9oYWRpYWgnID0+IGZvcm1fZXJyb3IoJ2thdGVnb3JpX2hhZGlhaCcpLA0KCQkJICAgIA0KCQkJKTsNCgkJCWVjaG8ganNvbl9lbmNvZGUoJGFycik7DQoJCX0gDQoJCWVsc2V7DQoJCQkkY29uZmlnWyd1cGxvYWRfcGF0aCddPSIuL2Fzc2V0cy9pbWciOw0KCSAgICAgICAgJGNvbmZpZ1snYWxsb3dlZF90eXBlcyddPSdnaWZ8anBnfHBuZyc7DQoJICAgICAgICAkdGhpcy0+bG9hZC0+bGlicmFyeSgndXBsb2FkJywkY29uZmlnKTsNCgkgICAgICAgIGlmKCR0aGlzLT51cGxvYWQtPmRvX3VwbG9hZCgiZmlsZSIpKXsNCgkJICAgICAgICAkZGF0YSA9IGFycmF5KCd1cGxvYWRfZGF0YScgPT4gJHRoaXMtPnVwbG9hZC0+ZGF0YSgpKTsNCgkJICAgICAgICAkaW1nX25hbWUgPSAkdGhpcy0+dXBsb2FkLT5kYXRhKCdmaWxlX25hbWUnKTsgDQoJCSAgICAgICAgJGRhdGEgPSBhcnJheSgNCgkJCQkJICdrYXRlZ29yaV9oYWRpYWgnID0+ICR0aGlzLT5pbnB1dC0+cG9zdCgia2F0ZWdvcmlfaGFkaWFoIiksCQkJCSANCgkJCQkJICduYW1hX2hhZGlhaCcgPT4gJHRoaXMtPmlucHV0LT5wb3N0KCJuYW1hX2hhZGlhaCIpLA0KCQkJCQkgJ2dhbWJhcl9oYWRpYWgnID0+ICRpbWdfbmFtZQ0KCQkJCSk7DQoJCQkJJHRoaXMtPmRiLT5pbnNlcnQoJ3RhX2hhZGlhaCcsICRkYXRhKTsNCgkJCQkNCgkJCQkkcmVzdWx0ID0gYXJyYXkoDQoJCQkJCSdzdGF0dXMnID0+ICJyZWxvYWQiLA0KCQkJCQknbXNnJyA9PiAiIg0KCQkJCSk7DQoJCQkJZWNobyBqc29uX2VuY29kZSgkcmVzdWx0KTsNCgkgICAgICAgIH0NCgkgICAgICAgIGVsc2V7DQoJICAgICAgICAJJGFyciA9IGFycmF5KA0KCQkJCSAgICAnZmlsZScgPT4gJHRoaXMtPnVwbG9hZC0+ZGlzcGxheV9lcnJvcnMoKQ0KCQkJCSk7DQoJCQkJZWNobyBqc29uX2VuY29kZSgkcmVzdWx0KTsNCgkgICAgICAgIH0NCgkJfQ0KICAgIH0NCg0KICAgIHB1YmxpYyBmdW5jdGlvbiBkZWxldGVfcmV3YXJkcygpew0KICAgIAkkZGF0YSA9ICR0aGlzLT5pbnB1dC0+cG9zdCgiaWRfZGVsZXRlIik7DQogICAgCSR0bXAgPSBleHBsb2RlKCJ8IiwgJGRhdGEpOw0KICAgIAkkdGFfaGFkaWFoX2lkID0gJHRtcFswXTsNCiAgICAJJGdhbWJhciA9ICR0bXBbMV07DQoNCiAgICAJJHRoaXMtPmRiLT5xdWVyeSgiREVMRVRFIGZyb20gdGFfaGFkaWFoIFdIRVJFIHRhX2hhZGlhaF9pZCA9ICR0YV9oYWRpYWhfaWQgIik7DQogICAgCWlmKGZpbGVfZXhpc3RzKCIuL2Fzc2V0cy9pbWcvIi4kZ2FtYmFyKSl7DQogICAgCQl1bmxpbmsoIi4vYXNzZXRzL2ltZy8iLiRnYW1iYXIpOw0KICAgIAl9DQogICAgCSRyZXN1bHQgPSBhcnJheSgNCgkJCSdzdGF0dXMnID0+ICJyZWxvYWQiLA0KCQkJJ21zZycgPT4gIiINCgkJKTsNCgkJZWNobyBqc29uX2VuY29kZSgkcmVzdWx0KTsNCiAgICB9DQoNCiAgICBwdWJsaWMgZnVuY3Rpb24gbG9nb19zYXZlKCl7DQogICAgCSRjb25maWdbJ3VwbG9hZF9wYXRoJ109Ii4vYXNzZXRzL2ltZyI7DQogICAgICAgICRjb25maWdbJ2FsbG93ZWRfdHlwZXMnXT0nZ2lmfGpwZ3xwbmd8anBlZyc7DQogICAgICAgICR0aGlzLT5sb2FkLT5saWJyYXJ5KCd1cGxvYWQnLCRjb25maWcpOw0KICAgICAgICBpZigkdGhpcy0+dXBsb2FkLT5kb191cGxvYWQoImZpbGUiKSl7DQoJICAgICAgICAkZGF0YSA9IGFycmF5KCd1cGxvYWRfZGF0YScgPT4gJHRoaXMtPnVwbG9hZC0+ZGF0YSgpKTsNCgkgICAgICAgICRpbWdfbmFtZSA9ICR0aGlzLT51cGxvYWQtPmRhdGEoJ2ZpbGVfbmFtZScpOyANCgkgICAgICAgIA0KCQkJJHRoaXMtPmRiLT5xdWVyeSgiVVBEQVRFIHBlbmdhdHVyYW4gc2V0IGxvZ28gPSAnIi4kaW1nX25hbWUuIiciKTsNCgkJCQ0KCQkJJHJlc3VsdCA9IGFycmF5KA0KCQkJCSdzdGF0dXMnID0+ICJyZWxvYWQiLA0KCQkJCSdtc2cnID0+ICIiDQoJCQkpOw0KCQkJZWNobyBqc29uX2VuY29kZSgkcmVzdWx0KTsNCiAgICAgICAgfQ0KICAgICAgICBlbHNlew0KICAgICAgICAJJGFyciA9IGFycmF5KA0KCQkJICAgICdmaWxlJyA9PiAkdGhpcy0+dXBsb2FkLT5kaXNwbGF5X2Vycm9ycygpDQoJCQkpOw0KCQkJZWNobyBqc29uX2VuY29kZSgkYXJyKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KCXB1YmxpYyBmdW5jdGlvbiBiZ19zYXZlKCl7DQogICAgCSRjb25maWdbJ3VwbG9hZF9wYXRoJ109Ii4vYXNzZXRzL2ltZyI7DQogICAgICAgICRjb25maWdbJ2FsbG93ZWRfdHlwZXMnXT0nZ2lmfGpwZ3xwbmd8anBlZyc7DQogICAgICAgICR0aGlzLT5sb2FkLT5saWJyYXJ5KCd1cGxvYWQnLCRjb25maWcpOw0KICAgICAgICBpZigkdGhpcy0+dXBsb2FkLT5kb191cGxvYWQoImZpbGUiKSl7DQoJICAgICAgICAkZGF0YSA9IGFycmF5KCd1cGxvYWRfZGF0YScgPT4gJHRoaXMtPnVwbG9hZC0+ZGF0YSgpKTsNCgkgICAgICAgICRpbWdfbmFtZSA9ICR0aGlzLT51cGxvYWQtPmRhdGEoJ2ZpbGVfbmFtZScpOyANCgkgICAgICAgIA0KCQkJJHRoaXMtPmRiLT5xdWVyeSgiVVBEQVRFIHBlbmdhdHVyYW4gc2V0IGJhY2tncm91bmQgPSAnIi4kaW1nX25hbWUuIiciKTsNCgkJCQ0KCQkJJHJlc3VsdCA9IGFycmF5KA0KCQkJCSdzdGF0dXMnID0+ICJyZWxvYWQiLA0KCQkJCSdtc2cnID0+ICIiDQoJCQkpOw0KCQkJZWNobyBqc29uX2VuY29kZSgkcmVzdWx0KTsNCiAgICAgICAgfQ0KICAgICAgICBlbHNlew0KICAgICAgICAJJGFyciA9IGFycmF5KA0KCQkJICAgICdmaWxlJyA9PiAkdGhpcy0+dXBsb2FkLT5kaXNwbGF5X2Vycm9ycygpDQoJCQkpOw0KCQkJZWNobyBqc29uX2VuY29kZSgkYXJyKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIHB1YmxpYyBmdW5jdGlvbiBwZW5nYXR1cmFuX3NhdmUoKXsNCgkJJHRhX3VuZGlhbl9uYW1hX2lkID0gJHRoaXMtPnNlc3Npb24tPnVzZXJkYXRhKCd0YV91bmRpYW5fbmFtYV9pZCcpOwkJDQoJCSR0aGlzLT5kYi0+cXVlcnkoIlVQREFURSB0YV91bmRpYW5fbmFtYSBzZXQgbmFtYV91bmRpYW4gPSAnIi4kdGhpcy0+aW5wdXQtPnBvc3QoJ25hbWFfdW5kaWFuJykuIicgd2hlcmUgdGFfdW5kaWFuX25hbWFfaWQgPSAkdGFfdW5kaWFuX25hbWFfaWQgIik7DQoJCXJlZGlyZWN0KCJwZW5nYXR1cmFuIik7DQoJfQ0KDQoJcHVibGljIGZ1bmN0aW9uIHBlbWVuYW5nX2RlbGV0ZSgpew0KCQkkdGhpcy0+ZGItPnNldCgndGFuZ2dhbF91bmRpYW4nLCBudWxsKTsJICANCgkJJHRoaXMtPmRiLT53aGVyZSgndGFuZ2dhbF91bmRpYW4gaXMgTk9UIE5VTEwnLCBOVUxMLCBGQUxTRSk7ICANCgkgICAgJHRoaXMtPmRiLT51cGRhdGUoJ3RhX3VuZGlhbl9uYW1hX2xpc3QnKTsNCgl9DQoJDQogICAgcHVibGljIGZ1bmN0aW9uIGltcG9ydCgpew0KICAgICAgICAkZmlsZV9taW1lcyA9IGFycmF5KCd0ZXh0L3gtY29tbWEtc2VwYXJhdGVkLXZhbHVlcycsICd0ZXh0L2NvbW1hLXNlcGFyYXRlZC12YWx1ZXMnLCAnYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtJywgJ2FwcGxpY2F0aW9uL3ZuZC5tcy1leGNlbCcsICdhcHBsaWNhdGlvbi94LWNzdicsICd0ZXh0L3gtY3N2JywgJ3RleHQvY3N2JywgJ2FwcGxpY2F0aW9uL2NzdicsICdhcHBsaWNhdGlvbi9leGNlbCcsICdhcHBsaWNhdGlvbi92bmQubXNleGNlbCcsICd0ZXh0L3BsYWluJywgJ2FwcGxpY2F0aW9uL3ZuZC5vcGVueG1sZm9ybWF0cy1vZmZpY2Vkb2N1bWVudC5zcHJlYWRzaGVldG1sLnNoZWV0Jyk7DQogICAgICAgIA0KICAgICAgICBpZihpc3NldCgkX0ZJTEVTWyJ1cGxvYWRfZmlsZSJdWyJuYW1lIl0pICYmIGluX2FycmF5KCRfRklMRVNbInVwbG9hZF9maWxlIl1bInR5cGUiXSwgJGZpbGVfbWltZXMpKSB7DQogICAgICAgICAgICAkYXJyX2ZpbGUgPSBleHBsb2RlKCIuIiwgJF9GSUxFU1sidXBsb2FkX2ZpbGUiXVsibmFtZSJdKTsNCiAgICAgICAgICAgICRleHRlbnNpb24gPSBlbmQoJGFycl9maWxlKTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgaWYoImNzdiIgPT0gJGV4dGVuc2lvbil7DQogICAgICAgICAgICAgICAgJHJlYWRlciA9IG5ldyBcUGhwT2ZmaWNlXFBocFNwcmVhZHNoZWV0XFJlYWRlclxDc3YoKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgJHJlYWRlciA9IG5ldyBcUGhwT2ZmaWNlXFBocFNwcmVhZHNoZWV0XFJlYWRlclxYbHN4KCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgICRzcHJlYWRzaGVldCA9ICRyZWFkZXItPmxvYWQoJF9GSUxFU1sidXBsb2FkX2ZpbGUiXVsidG1wX25hbWUiXSk7DQogICAgICAgICAgICAkc2hlZXREYXRhID0gJHNwcmVhZHNoZWV0LT5nZXRBY3RpdmVTaGVldCgpLT50b0FycmF5KCk7DQogICAgICAgICAgICAkc2hlZXRDb3VudCA9IGNvdW50KCRzaGVldERhdGEpOw0KICAgICAgICAgICAgJGRhdGEgPSBhcnJheSgpOw0KICAgIA0KICAgICAgICAgICAgZm9yICgkaSA9IDE7ICRpIDwgJHNoZWV0Q291bnQ7ICRpICsrKSB7DQogICAgICAgICAgICAgICAgJG5vX3VuZGlhbiA9ICRzaGVldERhdGFbJGldWzBdOw0KICAgICAgICAgICAgICAgICRuYW1hX3Blc2VydGEgPSAkc2hlZXREYXRhWyRpXVsxXTsNCiAgICAgICAgICAgICAgICAkbm9faHAgPSAkc2hlZXREYXRhWyRpXVsyXTsNCiAgICAgICAgICAgICAgICAkYWxhbWF0ID0gJHNoZWV0RGF0YVskaV1bM107DQogICAgICAgICAgICAgICAgJHBvaW50cyA9ICRzaGVldERhdGFbJGldWzRdOyAvLyBBc3N1bWluZyBDb2x1bW4gRSBpcyB0aGUgcG9pbnRzIGNvbHVtbg0KICAgIA0KICAgICAgICAgICAgICAgIC8vIExvb3AgYmFzZWQgb24gdGhlIG51bWVyaWMgdmFsdWUgaW4gQ29sdW1uIEQNCiAgICAgICAgICAgICAgICBmb3IgKCRqID0gMTsgJGogPD0gJHBvaW50czsgJGorKykgew0KICAgICAgICAgICAgICAgICAgICAkYXV0b19udW1iZXJlZF9ub191bmRpYW4gPSAkbm9fdW5kaWFuIC4gJy0nIC4gJGo7DQogICAgICAgICAgICAgICAgICAgIGFycmF5X3B1c2goJGRhdGEsIGFycmF5KA0KICAgICAgICAgICAgICAgICAgICAgICAgJ25vX3VuZGlhbicgPT4gJGF1dG9fbnVtYmVyZWRfbm9fdW5kaWFuLA0KICAgICAgICAgICAgICAgICAgICAgICAgJ25hbWFfcGVzZXJ0YScgPT4gJG5hbWFfcGVzZXJ0YSwNCiAgICAgICAgICAgICAgICAgICAgICAgICdub19ocCcgPT4gJG5vX2hwLA0KICAgICAgICAgICAgICAgICAgICAgICAgJ2FsYW1hdCcgPT4gJGFsYW1hdA0KICAgICAgICAgICAgICAgICAgICApKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgDQogICAgICAgICAgICAkdGhpcy0+ZGItPnRyYW5zX3N0YXJ0KCk7DQogICAgICAgICAgICAkX2RhdGFzID0gYXJyYXlfY2h1bmsoJGRhdGEsIDUwMCk7DQogICAgDQogICAgICAgICAgICBmb3JlYWNoICgkX2RhdGFzIGFzICRrZXkgPT4gJHNwbGl0Mikgew0KICAgICAgICAgICAgICAgICR0aGlzLT5kYi0+aW5zZXJ0X2JhdGNoKCJ0YV9wZXNlcnRhIiwgJHNwbGl0Mik7DQogICAgICAgICAgICB9DQogICAgDQogICAgICAgICAgICAkdGhpcy0+ZGItPnRyYW5zX2NvbXBsZXRlKCk7DQogICAgICAgICAgICAkdGhpcy0+ZGItPnF1ZXJ5KCJERUxFVEUgRlJPTSB0YV9wZXNlcnRhIFdIRVJFIG5vX3VuZGlhbiBJUyBOVUxMIE9SIG5vX3VuZGlhbiA9ICcnIik7DQogICAgDQogICAgICAgICAgICAkcmVzdWx0ID0gYXJyYXkoDQogICAgICAgICAgICAgICAgJ3N0YXR1cycgPT4gInJlbG9hZCIsDQogICAgICAgICAgICAgICAgJ21zZycgPT4gIiINCiAgICAgICAgICAgICk7DQogICAgDQogICAgICAgICAgICBlY2hvIGpzb25fZW5jb2RlKCRyZXN1bHQpOw0KICAgICAgICB9DQogICAgfQ0KDQoNCglwdWJsaWMgZnVuY3Rpb24gaW1wb3J0X2V4Y2VsKCl7DQoJCS8vcmVxdWlyZV9vbmNlIEFQUFBBVEggLiAiL3RoaXJkX3BhcnR5L1BIUEV4Y2VsL1BIUEV4Y2VsLnBocCI7DQoJCXNldF90aW1lX2xpbWl0KDApOw0KCQlpbmlfc2V0KCdtZW1vcnlfbGltaXQnLCAnLTEnKTsJDQoJCSR0aGlzLT5sb2FkLT5saWJyYXJ5KGFycmF5KCdQSFBFeGNlbCcsJ1BIUEV4Y2VsL0lPRmFjdG9yeScpKTsNCiAgICAgICAgJGZpbGVOYW1lID0gdGltZSgpLiRfRklMRVNbJ2ZpbGUnXVsnbmFtZSddOw0KICAgICAgICAgDQogICAgICAgICRjb25maWdbJ3VwbG9hZF9wYXRoJ10gPSAnLi9hc3NldHMvcGVzZXJ0YS8nOw0KICAgICAgICAkY29uZmlnWydmaWxlX25hbWUnXSA9ICRmaWxlTmFtZTsNCiAgICAgICAgJGNvbmZpZ1snYWxsb3dlZF90eXBlcyddID0gJ3hsc3x4bHN4fGNzdic7DQogICAgICAgICRjb25maWdbJ21heF9zaXplJ10gPSAxMDAwMDsNCiAgICAgICAgIA0KICAgICAgICAkdGhpcy0+bG9hZC0+bGlicmFyeSgndXBsb2FkJyk7DQogICAgICAgICR0aGlzLT51cGxvYWQtPmluaXRpYWxpemUoJGNvbmZpZyk7DQogICAgICAgICANCiAgICAgICAgaWYoISAkdGhpcy0+dXBsb2FkLT5kb191cGxvYWQoJ2ZpbGUnKSApDQogICAgICAgICR0aGlzLT51cGxvYWQtPmRpc3BsYXlfZXJyb3JzKCk7DQogICAgICAgICAgICAgDQogICAgICAgICRtZWRpYSA9ICR0aGlzLT51cGxvYWQtPmRhdGEoJ2ZpbGUnKTsNCiAgICAgICAgJGltZ19uYW1lID0gJHRoaXMtPnVwbG9hZC0+ZGF0YSgnZmlsZV9uYW1lJyk7DQogICAgICAgICRpbnB1dEZpbGVOYW1lID0gJy4vYXNzZXRzL3Blc2VydGEvJy4kaW1nX25hbWU7DQogICAgICAgICAgICAgICAgDQogICAgICAgIHRyeSB7DQoJCQkkaW5wdXRGaWxlVHlwZSA9IElPRmFjdG9yeTo6aWRlbnRpZnkoJGlucHV0RmlsZU5hbWUpOw0KCQkJJG9ialJlYWRlciA9IElPRmFjdG9yeTo6Y3JlYXRlUmVhZGVyKCRpbnB1dEZpbGVUeXBlKTsNCgkJCSRvYmpQSFBFeGNlbCA9ICRvYmpSZWFkZXItPmxvYWQoJGlucHV0RmlsZU5hbWUpOw0KCQl9IGNhdGNoKEV4Y2VwdGlvbiAkZSkgew0KCQkJZGllKCdFcnJvciBsb2FkaW5nIGZpbGUgIicucGF0aGluZm8oJGlucHV0RmlsZU5hbWUsUEFUSElORk9fQkFTRU5BTUUpLiciOiAnLiRlLT5nZXRNZXNzYWdlKCkpOw0KCQl9DQogDQoJCSRzaGVldCA9ICRvYmpQSFBFeGNlbC0+Z2V0U2hlZXQoMCk7DQoJCSRoaWdoZXN0Um93ID0gJHNoZWV0LT5nZXRIaWdoZXN0Um93KCk7DQoJCSRoaWdoZXN0Q29sdW1uID0gJHNoZWV0LT5nZXRIaWdoZXN0Q29sdW1uKCk7DQoJCQ0KICAgICAgICAkZGF0YSA9IGFycmF5KCk7DQoJCWZvciAoJHJvdyA9IDI7ICRyb3cgPD0gJGhpZ2hlc3RSb3c7ICRyb3crKyl7DQoJCQkkcm93RGF0YSA9ICRzaGVldC0+cmFuZ2VUb0FycmF5KCdBJyAuICRyb3cgLiAnOicgLiAkaGlnaGVzdENvbHVtbiAuICRyb3csDQoJCQkJCQkJCQkJCU5VTEwsDQoJCQkJCQkJCQkJCVRSVUUsDQoJCQkJCQkJCQkJCUZBTFNFKTsNCgkJCQkJCQkJCQkJCQkJCQ0KCQkJJG5vX3VuZGlhbiA9IHRyaW0oJHJvd0RhdGFbMF1bMF0pOw0KCQkJaWYoJG5vX3VuZGlhbiAhPSAiIil7DQoJCQkJYXJyYXlfcHVzaCgkZGF0YSxhcnJheSgNCgkJCQkJIm5vX3VuZGlhbiI9PiAkcm93RGF0YVswXVswXSwNCgkJCQkJIm5hbWFfcGVzZXJ0YSI9PiAkcm93RGF0YVswXVsxXSwgICAgICAgICAgICAgICAgICAgIA0KCQkJCQkiYWxhbWF0Ij0+ICRyb3dEYXRhWzBdWzJdLA0KCQkJCSkpOw0KCQkJfQkJCQkJCQkJCQkJCQkNCgkJfQ0KDQogICAgICAgICR0aGlzLT5kYi0+dHJhbnNfc3RhcnQoKTsNCiAgICAgICAgJF9kYXRhcyA9IGFycmF5X2NodW5rKCRkYXRhLCAzMDApOw0KICAgICAgICBmb3JlYWNoICgkX2RhdGFzIGFzICRrZXkgPT4gJHNwbGl0KSB7DQogICAgICAgICAgICAkdGhpcy0+ZGItPmluc2VydF9iYXRjaCgndGFfcGVzZXJ0YScsICRzcGxpdCk7DQogICAgICAgIH0NCiAgICAgICAgJHRoaXMtPmRiLT50cmFuc19jb21wbGV0ZSgpOw0KDQoJCSR0aGlzLT5kYi0+cXVlcnkoIkRFTEVURSBmcm9tIHRhX3Blc2VydGEgd2hlcmUgbm9fdW5kaWFuIGlzIG51bGwgb3Igbm9fdW5kaWFuID0gJycgIik7DQoJCWRlbGV0ZV9maWxlcygnLi9hc3NldHMvcGVzZXJ0YS8nKTsNCgkJJHJlc3VsdCA9IGFycmF5KA0KCQkJJ3N0YXR1cycgPT4gInJlbG9hZCIsDQoJCQknbXNnJyA9PiAiIg0KCQkpOw0KCQllY2hvIGpzb25fZW5jb2RlKCRyZXN1bHQpOw0KICAgIH0NCg0KCXB1YmxpYyBmdW5jdGlvbiB1cGxvYWRfY3N2KCkNCiAgICB7DQogICAgICAgIHNldF90aW1lX2xpbWl0KDApOw0KICAgICAgICBpbmlfc2V0KCdtZW1vcnlfbGltaXQnLCAnLTEnKTsgICAgICAgIA0KICAgIA0KICAgICAgICBpZiAoJHRoaXMtPmlucHV0LT5wb3N0KCdpbXBvcnRTdWJtaXQnKSkgew0KICAgICAgICAgICAgJHRoaXMtPmZvcm1fdmFsaWRhdGlvbi0+c2V0X3J1bGVzKCdmaWxlJywgJ0NTViBmaWxlJywgJ2NhbGxiYWNrX2ZpbGVfY2hlY2snKTsNCiAgICAgICAgICAgICRpbnNlcnRDb3VudCA9ICR1cGRhdGVDb3VudCA9ICRyb3dDb3VudCA9ICRub3RBZGRDb3VudCA9IDA7DQogICAgDQogICAgICAgICAgICBpZiAoaXNfdXBsb2FkZWRfZmlsZSgkX0ZJTEVTWydmaWxlJ11bJ3RtcF9uYW1lJ10pKSB7DQogICAgICAgICAgICAgICAgJHRoaXMtPmxvYWQtPmxpYnJhcnkoJ0NTVlJlYWRlcicpOw0KICAgICAgICAgICAgICAgICRjc3ZEYXRhID0gJHRoaXMtPmNzdnJlYWRlci0+cGFyc2VfY3N2KCRfRklMRVNbJ2ZpbGUnXVsndG1wX25hbWUnXSk7DQogICAgDQogICAgICAgICAgICAgICAgaWYgKCFlbXB0eSgkY3N2RGF0YSkpIHsNCiAgICAgICAgICAgICAgICAgICAgJGRhdGEgPSBhcnJheSgpOw0KICAgIA0KICAgICAgICAgICAgICAgICAgICBmb3JlYWNoICgkY3N2RGF0YSBhcyAkcm93KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAkcm93Q291bnQrKzsNCiAgICANCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEdldCB0aGUgbnVtYmVyIG9mIHBvaW50cyBmb3IgdGhlIHBhcnRpY2lwYW50DQogICAgICAgICAgICAgICAgICAgICAgICAkcG9pbnRzID0gaXNzZXQoJHJvd1sncG9pbnRzJ10pID8gKGludCkkcm93Wydwb2ludHMnXSA6IDE7DQogICAgDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBEdXBsaWNhdGUgdGhlIHBhcnRpY2lwYW50IGJhc2VkIG9uIHRoZSBwb2ludHMNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoJGkgPSAwOyAkaSA8ICRwb2ludHM7ICRpKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcnJheV9wdXNoKCRkYXRhLCBhcnJheSgNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ25vX3VuZGlhbicgPT4gJHJvd1snbm9tb3JfdW5kaWFuJ10sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICduYW1hX3Blc2VydGEnID0+ICRyb3dbJ25hbWFfcGVzZXJ0YSddLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbm9faHAnID0+ICRyb3dbJ25vX2hwJ10sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdhbGFtYXQnID0+ICRyb3dbJ2FsYW1hdCddDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgKSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICANCiAgICAgICAgICAgICAgICAgICAgJHRoaXMtPmRiLT50cmFuc19zdGFydCgpOw0KICAgICAgICAgICAgICAgICAgICAkX2RhdGFzID0gYXJyYXlfY2h1bmsoJGRhdGEsIDMwMCk7DQogICAgDQogICAgICAgICAgICAgICAgICAgIGZvcmVhY2ggKCRfZGF0YXMgYXMgJGtleSA9PiAkc3BsaXQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5kYi0+aW5zZXJ0X2JhdGNoKCd0YV9wZXNlcnRhJywgJHNwbGl0KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgIA0KICAgICAgICAgICAgICAgICAgICAkdGhpcy0+ZGItPnRyYW5zX2NvbXBsZXRlKCk7DQogICAgDQogICAgICAgICAgICAgICAgICAgICRyZXN1bHQgPSBhcnJheSgNCiAgICAgICAgICAgICAgICAgICAgICAgICdzdGF0dXMnID0+ICJyZWxvYWQiLA0KICAgICAgICAgICAgICAgICAgICAgICAgJ21zZycgPT4gIiINCiAgICAgICAgICAgICAgICAgICAgKTsNCiAgICAgICAgICAgICAgICAgICAgZWNobyBqc29uX2VuY29kZSgkcmVzdWx0KTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICRyZXN1bHQgPSBhcnJheSgNCiAgICAgICAgICAgICAgICAgICAgJ3N0YXR1cycgPT4gImFsZXJ0IiwNCiAgICAgICAgICAgICAgICAgICAgJ21zZycgPT4gIkFkYSBtYXNhbGFoLCBoYXJhcCBjb2JhIGxhZ2kiDQogICAgICAgICAgICAgICAgKTsNCiAgICAgICAgICAgICAgICBlY2hvIGpzb25fZW5jb2RlKCRyZXN1bHQpOw0KICAgICAgICAgICAgfQ0KICAgIA0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgJHJlc3VsdCA9IGFycmF5KA0KICAgICAgICAgICAgICAgICdzdGF0dXMnID0+ICJhbGVydCIsDQogICAgICAgICAgICAgICAgJ21zZycgPT4gIlRlcmRhcGF0IGtlc2FsYWhhbiAhIg0KICAgICAgICAgICAgKTsNCiAgICAgICAgICAgIGVjaG8ganNvbl9lbmNvZGUoJHJlc3VsdCk7DQogICAgICAgIH0NCiAgICB9DQogDQoJcHVibGljIGZ1bmN0aW9uIGZpbGVfY2hlY2soJHN0cil7DQogICAgICAgICRhbGxvd2VkX21pbWVfdHlwZXMgPSBhcnJheSgndGV4dC94LWNvbW1hLXNlcGFyYXRlZC12YWx1ZXMnLCAndGV4dC9jb21tYS1zZXBhcmF0ZWQtdmFsdWVzJywgJ2FwcGxpY2F0aW9uL29jdGV0LXN0cmVhbScsICdhcHBsaWNhdGlvbi92bmQubXMtZXhjZWwnLCAnYXBwbGljYXRpb24veC1jc3YnLCAndGV4dC94LWNzdicsICd0ZXh0L2NzdicsICdhcHBsaWNhdGlvbi9jc3YnLCAnYXBwbGljYXRpb24vZXhjZWwnLCAnYXBwbGljYXRpb24vdm5kLm1zZXhjZWwnLCAndGV4dC9wbGFpbicpOw0KICAgICAgICBpZihpc3NldCgkX0ZJTEVTWydmaWxlJ11bJ25hbWUnXSkgJiYgJF9GSUxFU1snZmlsZSddWyduYW1lJ10gIT0gIiIpew0KICAgICAgICAgICAgJG1pbWUgPSBnZXRfbWltZV9ieV9leHRlbnNpb24oJF9GSUxFU1snZmlsZSddWyduYW1lJ10pOw0KICAgICAgICAgICAgJGZpbGVBciA9IGV4cGxvZGUoJy4nLCAkX0ZJTEVTWydmaWxlJ11bJ25hbWUnXSk7DQogICAgICAgICAgICAkZXh0ID0gZW5kKCRmaWxlQXIpOw0KICAgICAgICAgICAgaWYoKCRleHQgPT0gJ2NzdicpICYmIGluX2FycmF5KCRtaW1lLCAkYWxsb3dlZF9taW1lX3R5cGVzKSl7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgICAgICAkdGhpcy0+Zm9ybV92YWxpZGF0aW9uLT5zZXRfbWVzc2FnZSgnZmlsZV9jaGVjaycsICdQbGVhc2Ugc2VsZWN0IG9ubHkgQ1NWIGZpbGUgdG8gdXBsb2FkLicpOw0KICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAkdGhpcy0+Zm9ybV92YWxpZGF0aW9uLT5zZXRfbWVzc2FnZSgnZmlsZV9jaGVjaycsICdQbGVhc2Ugc2VsZWN0IGEgQ1NWIGZpbGUgdG8gdXBsb2FkLicpOw0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgcHVibGljIGZ1bmN0aW9uIHBhc3N3b3JkKCl7DQogICAgCSR0aGlzLT5mb3JtX3ZhbGlkYXRpb24tPnNldF9ydWxlcygncGFzc19iJywncGFzc3dvcmQgYmFydScsICdyZXF1aXJlZCcpOw0KCQkkdGhpcy0+Zm9ybV92YWxpZGF0aW9uLT5zZXRfcnVsZXMoJ3Bhc3NfYycsJ2tvbmZpcm1hc2kgcGFzc3dvcmQnLCAncmVxdWlyZWR8bWF0Y2hlc1twYXNzX2JdJyk7DQoNCgkJaWYgKCR0aGlzLT5mb3JtX3ZhbGlkYXRpb24tPnJ1bigpID09IEZBTFNFKSB7DQoJCQkkZGF0YSA9IGFycmF5KA0KCQkJCSdwYXNzX2InID0+IGZvcm1fZXJyb3IoJ3Bhc3NfYicpLA0KCQkgICAgCSdwYXNzX2MnID0+IGZvcm1fZXJyb3IoJ3Bhc3NfYycpDQogICAgICAgICAgICApOw0KICAgICAgICAgICAgZWNobyBqc29uX2VuY29kZSgkZGF0YSk7CQkgICAgDQoJCX0gDQoJCWVsc2V7DQoJCQkkcGFzc3dvcmQgPSAkdGhpcy0+aW5wdXQtPnBvc3QoJ3Bhc3NfYicsVFJVRSk7DQoNCgkJCSRkYXRhID0gYXJyYXkoCQkJCQ0KCQkJCSdwYXNzd29yZCcgPT4gcGFzc3dvcmRfaGFzaCgkcGFzc3dvcmQsIFBBU1NXT1JEX0RFRkFVTFQpDQoJCQkpOw0KCQkJJHRoaXMtPmRiLT53aGVyZSgndGFfdXNlcl9pZCcsMSk7DQoJCQkkdGhpcy0+ZGItPnVwZGF0ZSgndGFfdXNlcicsJGRhdGEpOw0KCQkJJHRoaXMtPnNlc3Npb24tPnNldF9mbGFzaGRhdGEoJ3N1Y2Nlc3MnLCAnUGFzc3dvcmQgYmVyaGFzaWwgZGl1YmFoJyk7DQoJCQkNCgkJCSRyZXN1bHQgPSBhcnJheSgNCgkJCQknc3RhdHVzJyA9PiAicmVsb2FkIiwNCgkJCQknbXNnJyA9PiAiIg0KCQkJKTsNCgkJCWVjaG8ganNvbl9lbmNvZGUoJHJlc3VsdCk7DQoJCX0NCiAgICB9DQoJDQoJcHVibGljIGZ1bmN0aW9uIGVycm9yKCl7DQoJCSRkYXRhWydkZXNjcmlwdGlvbiddID0gIiI7DQoJCSRkYXRhWyd0aXRsZSddID0gIktlc2FsYWhhbiI7DQoJCSRkYXRhWydrZXl3b3JkcyddID0gIiI7DQoJCSRkYXRhWyJjb250ZW50Il0gPSAiZXJyb3IiOw0KCQkkdGhpcy0+bG9hZC0+dmlldygndGVtcGxhdGUnLCAkZGF0YSk7DQoJfQ0KDQoJcHVibGljIGZ1bmN0aW9uIGJhdGFsKCkNCgl7CQkJCQ0KCQkkZGF0YVsndGl0bGUnXSA9ICJBcGxpa2FzaSBVbmRpYW4iOw0KCQkkZGF0YVsiY29udGVudCJdID0gImJhdGFsIjsNCgkJJGRhdGFbJ3BlbmdhdHVyYW4nXSA9ICR0aGlzLT5kYi0+Z2V0KCJwZW5nYXR1cmFuIiktPnJvdygpOw0KCQkkdGhpcy0+bG9hZC0+dmlldygndGVtcGxhdGUnLCAkZGF0YSk7DQoJfQ0KDQoJZnVuY3Rpb24gZ2V0X2JhdGFsKCkNCiAgICB7DQogICAgCSR0aGlzLT5sb2FkLT5tb2RlbCgnUGVzZXJ0YUJhdGFsX21vZGVsJyk7DQogICAgICAgICRsaXN0ID0gJHRoaXMtPlBlc2VydGFCYXRhbF9tb2RlbC0+Z2V0X2RhdGF0YWJsZXMoKTsNCiAgICAgICAgJGRhdGEgPSBhcnJheSgpOw0KICAgICAgICAkbm8gPSAkX1BPU1RbJ3N0YXJ0J107DQogICAgICAgIGZvcmVhY2ggKCRsaXN0IGFzICRmaWVsZCkgew0KICAgICAgICAgICAgJG5vKys7DQogICAgICAgICAgICAkcm93ID0gYXJyYXkoKTsNCiAgICAgICAgICAgICRyb3dbXSA9ICRmaWVsZC0+bm9fdW5kaWFuOw0KICAgICAgICAgICAgJHJvd1tdID0gJGZpZWxkLT5uYW1hX3Blc2VydGE7ICAgICAgICAgICAgDQogICAgICAgICAgICAkcm93W10gPSAkZmllbGQtPmFsYW1hdDsgICANCgkJCSRyb3dbXSA9ICc8YSBocmVmPSJqYXZhc2NyaXB0OnZvaWQoMCkiIGNsYXNzPSJkZWxldGUtYnktb25lIiBpZD0iJy4kZmllbGQtPnRhX3Blc2VydGFfaWQuJyI+PGkgY2xhc3M9ImZhIGZhLXRyYXNoIHRleHQtZGFuZ2VyIj48L2k+PC9hPic7ICAgICAgICAgIA0KICAgICAgICAgICAgJGRhdGFbXSA9ICRyb3c7DQogICAgICAgIH0NCiANCiAgICAgICAgJG91dHB1dCA9IGFycmF5KA0KICAgICAgICAgICAgImRyYXciID0+ICRfUE9TVFsnZHJhdyddLA0KICAgICAgICAgICAgInJlY29yZHNUb3RhbCIgPT4gJHRoaXMtPlBlc2VydGFCYXRhbF9tb2RlbC0+Y291bnRfYWxsKCksDQogICAgICAgICAgICAicmVjb3Jkc0ZpbHRlcmVkIiA9PiAkdGhpcy0+UGVzZXJ0YUJhdGFsX21vZGVsLT5jb3VudF9maWx0ZXJlZCgpLA0KICAgICAgICAgICAgImRhdGEiID0+ICRkYXRhLA0KICAgICAgICApOw0KICAgICAgICAvL291dHB1dCBkYWxhbSBmb3JtYXQgSlNPTg0KICAgICAgICBlY2hvIGpzb25fZW5jb2RlKCRvdXRwdXQpOw0KICAgIH0gCQ0KCQ0KfQ0K")); ?>